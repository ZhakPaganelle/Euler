##Gathering the beans

Whenever Peter feels bored, he places some bowls, containing one bean each, in a circle. After this, he takes all the beans out of a certain bowl and drops them one by one in the bowls going clockwise. He repeats this, starting from the bowl he dropped the last bean in, until the initial situation appears again. For example with 5 bowls he acts as follows:
So with 5 bowls it takes Peter 15 moves to return to the initial situation.
Let M(x) represent the number of moves required to return to the initial situation, starting with x bowls. Thus, M(5) = 15. It can also be verified that M(100) = 10920.
Find $\displaystyle \sum_{k=0}^{10^{18}} M(2^k + 1)$. Give your answer modulo 79.
##Сбор бобов

Каждый раз, когда Питеру становится скучно, он расставляет в круг несколько мисок, в каждой из которых лежит один боб. После этого он берет бобы из определенной миски и кладет их по одному в следующие миски, продвигаясь по часовой стрелке. Он повторяет процесс, начиная с миски, в которую он бросил последний боб, до тех пор, пока не получит исходное положение мисок. Например, в случае с 5 мисками, он действует следующим образом:

Таким образом, с 5 мисками Питеру потребовалось совершить 15 ходов, чтобы вернуться в исходное положение.
Пусть M(x) - число ходов, необходимое для того, чтобы вернуться в исходное положение для x мисок. Таким образом, M(5) = 15. Можно убедиться, что M(100) = 10920.
Найдите  M(2k+1). Ответ приведите по модулю 79.
