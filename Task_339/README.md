##Peredur fab Efrawg


"And he came towards a valley, through which ran a river; and the borders of the valley were wooded, and on each side of the river were level meadows. And on one side of the river he saw a flock of white sheep, and on the other a flock of black sheep. And whenever one of the white sheep bleated, one of the black sheep would cross over and become white; and when one of the black sheep bleated, one of the white sheep would cross over and become black."en.wikisource.org



Initially each flock consists of n sheep. Each sheep (regardless of colour) is equally likely to be the next sheep to bleat. After a sheep has bleated and a sheep from the other flock has crossed over, Peredur may remove a number of white sheep in order to maximize the expected final number of black sheep. Let E(n) be the expected final number of black sheep if Peredur uses an optimal strategy.



You are given that E(5) = 6.871346 rounded to 6 places behind the decimal point.
Find E(10 000) and give your answer rounded to 6 places behind the decimal point.

##Передур, сын Эвраука

"...Передур же поехал дальше долиной реки, вдоль которой расстилались луга. И на одном берегу реки он увидел стадо белых овец, а на другом - стадо черных. И как только одна из белых овец блеяла, черная овца переплывала реку и становилась белой. Когда же блеяла черная овца, одна из белых овец переплывала реку и делалась черной."
Мабиногион.
Передур, сын Эвраука

Изначально, каждое стадо состоит из n овец. Каждая овца (независимо от цвета) с равной вероятностью может блеять следующей. После того, как овца проблеяла и овца из другого стада пересекла реку, Передур может убрать некоторое число белых овец, чтобы обеспечить в конце максимальное число черных овец. Пусть E(n) - ожидаемое конечное значение числа черных овец, если Передур использует оптимальную стратегию.


Известно, что E(5) = 6.871346 (округлено до 6 знака после десятичной точки).
Найдите E(10 000) и приведите ответ, округлив его до 6 знака после десятичной точки.

