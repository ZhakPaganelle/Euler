##Best Approximations

Let $x$ be a real number.
A best approximation to $x$ for the denominator bound $d$ is a rational number $\frac r s $  in reduced form, with $s \le d$, such that any rational number which is closer to $x$ than $\frac r s$ has a denominator larger than $d$:
For example, the best approximation to $\sqrt {13}$ for the denominator bound 20 is $\frac {18} 5$ and the best approximation to $\sqrt {13}$ for the denominator bound 30 is $\frac {101}{28}$.
Find the sum of all denominators of the best approximations to $\sqrt n$ for the denominator bound $10^{12}$, where $n$ is not a perfect square and $ 1 < n \le 100000$. 
##Наилучшие аппроксимации

Пусть x - действительное число.
Наилучшая аппроксимация x для ограниченного знаменателя d - рациональная дробь r/s в сокращенной форме, у которой s ≤ d, такая, что любое рациональное число, которое ближе к x, чем к r/s, имеет знаменатель больше d:
|p/q-x| < |r/s-x| ⇒ q > d
К примеру, наилучшая аппроксимация √13 для знаменателя, ограниченного значением 20, составляет 18/5. В свою очередь, для знаменателя, ограниченного значением 30, наилучшая аппроксимация √13 равна 101/28.
Найдите сумму всех знаменателей наилучших аппроксимаций √n, при ограничении на знаменатель равном 1012, где n не является идеальным квадратом и 1 < n ≤ 100000.
